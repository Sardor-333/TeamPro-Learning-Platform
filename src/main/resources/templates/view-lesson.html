<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <style>
        body {
            background-color: #eee
        }

        .card {
            background-color: #fff;
            border: none
        }

        .form-color {
            background-color: #fafafa
        }

        .form-control {
            height: 48px;
            border-radius: 25px
        }

        .form-control:focus {
            color: #495057;
            background-color: #fff;
            border-color: #35b69f;
            outline: 0;
            box-shadow: none;
            text-indent: 10px
        }

        .c-badge {
            background-color: #35b69f;
            color: white;
            height: 20px;
            font-size: 11px;
            width: 92px;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 2px
        }

        .comment-text {
            font-size: 13px
        }

        .wish {
            color: #35b69f
        }

        .user-feed {
            font-size: 14px;
            margin-top: 12px
        }

        .vidwrapper {
            width: 100%;
            max-width: 800px;
            margin: 3em auto;
            border: 3px solid green;
        }

        .vidcontainer {
            width: 100%;
            max-width: 100%;
            height: 0;
            padding-bottom: 56.25%;
            border: 3px solid orange;
            position: relative;
        }

        .vidcontainer iframe, .vidcontainer video {
            width: 100%;
            max-width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css'>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.bundle.min.js">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <title>Lesson</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- Font Awesome -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
            rel="stylesheet"
    />
    <!-- Google Fonts -->
    <link
            href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
            rel="stylesheet"
    />
    <!-- MDB -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.css"
            rel="stylesheet"
    />
    <!-- MDB -->
    <script
            type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.js"
    ></script>

</head>
<body>
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <!-- Container wrapper -->
    <div class="container-fluid">
        <!-- Toggle button -->
        <button
                class="navbar-toggler"
                type="button"
                data-mdb-toggle="collapse"
                data-mdb-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent"
                aria-expanded="false"
                aria-label="Toggle navigation"
        >
            <i class="fas fa-bars"></i>
        </button>

        <!-- Collapsible wrapper -->
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <!-- Navbar brand -->
            <a class="navbar-brand mt-2 mt-lg-0" href="#">
                <img
                        src="https://groupteampro.com/wp-content/uploads/2019/10/team-pro.png"
                        height="55"
                        alt="Team Pro Logo"
                        loading="lazy"
                />
            </a>
            <!-- Left links -->
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link active rounded   " style="background-color: gainsboro; "
                       th:href="'lessons/'+${lesson.getModule().getId()}">Lessons</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/courses">Courses</a>
                </li>

            </ul>
            <!-- Left links -->
        </div>
        <!-- Collapsible wrapper -->

        <!-- Right elements -->
        <div class="d-flex align-items-center">
            <!-- Icon -->
            <!--            <a class="text-reset me-3" href="#">-->
            <!--                <i class="fas fa-shopping-cart"></i>-->
            <!--            </a>-->

            <!-- Notifications -->
            <div class="dropdown">
                <a
                        class="text-reset me-3 dropdown-toggle hidden-arrow"
                        href="#"
                        id="navbarDropdownMenuLink"
                        role="button"
                        data-mdb-toggle="dropdown"
                        aria-expanded="false"
                >
                    <i class="fas fa-bell"></i>
                    <span class="badge rounded-pill badge-notification bg-danger">1</span>
                </a>
                <ul
                        class="dropdown-menu dropdown-menu-end"
                        aria-labelledby="navbarDropdownMenuLink"
                >
                    <li>
                        <a class="dropdown-item" href="#">Some news</a>
                    </li>
                    <li>
                        <a class="dropdown-item" href="#">Another news</a>
                    </li>
                    <li>
                        <a class="dropdown-item" href="/auth/logOut">Log out</a>
                    </li>
                </ul>
            </div>
            <!-- Avatar -->
            <div class="dropdown">
                <a
                        class="dropdown-toggle d-flex align-items-center hidden-arrow"
                        href="#"
                        id="navbarDropdownMenuAvatar"
                        role="button"
                        data-mdb-toggle="dropdown"
                        aria-expanded="false"
                >
                    <img
                            src="https://mdbcdn.b-cdn.net/img/new/avatars/2.webp"
                            class="rounded-circle"
                            height="25"
                            alt="Black and White Portrait of a Man"
                            loading="lazy"
                    />
                </a>
                <ul
                        class="dropdown-menu dropdown-menu-end"
                        aria-labelledby="navbarDropdownMenuAvatar"
                >
                    <li>
                        <a class="dropdown-item" href="/categories/edit-profile">Edit profile</a>
                    </li>

                    <li>
                        <a class="dropdown-item" href="#">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Right elements -->
    </div>
    <!-- Container wrapper -->
</nav>

<div class="d-flex">

    <a th:if="${role=='ADMIN' or role =='SUPER_ADMIN'}" th:href="'lessons/add/video/'+${lesson.getId()}"
       class="btn btn-success">+ ADD VIDEO</a>
    <a th:if="${role=='ADMIN' or role =='SUPER_ADMIN'}" th:href="'lessons/uploadForm/'+${lesson.getId()}"
       class="btn btn-success">+ ADD TASK</a>
</div>
<div class="container">
    <br>
    <br>
    <br>
    <table class="table table-hover">
        <thead>
        <tr>
        </tr>
        </thead>
        <tbody>
        <tr class="table-info">
            <th scope="row" th:text="'Module: '+${lesson.getModule().getName()}"></th>
        </tr>
        <tr class="table-info">
            <th scope="row" th:text="'Theme: '+${lesson.getTheme()}"></th>
        </tr>
        <div>
            <tr>
                <div th:each="video: ${lessonVideos}">
                    <th scope="row">
                        <a th:href="'/lessons/redirect/video/'+${video.getFileName()}"><i class="fas fa-video fa-2x"></i></a>
                        <span th:text="${video.getOriginalFileName()}"></span>
                    </th>
                </div>
            </tr>
        </div>

        </tbody>
    </table>
    <br>
    <br>
    <div th:if="${lesson.getTasks()!=null and lesson.getTasks().size()>0}">
        <div class="d-flex"
             th:style="'padding-right: '+${100 / lesson.getTasks().size()} +'%; padding-left: ' +${100 / lesson.getTasks().size()} + '%; justify-content: space-between;'">
            <div th:each="task: ${lesson.getTasks()}">
                <a th:href="'/lessons/show/task/'+${task.getId()}" style="text-decoration: none">
                    <i class="fas fa-file-alt fa-4x"></i></a>
            </div>
        </div>
    </div>

    <br>
    <br>
    <br>
    <br>
    <div th:if="${infoTask != null}">
        <p th:text="${infoTask.getQuestion()}" class="center"></p>
        <p style="text-decoration: none; padding-left: 40%;">
            <a th:href="'/lessons/download/'+${infoTask.getId()}">
                <i class="fas fa-file-download fa-3x"></i>
            </a>
        </p>
    </div>
    <div class="container mt-5 mb-5">
        <div class="row height d-flex justify-content-center align-items-center">
            <div class="col-md-7">
                <div class="card">
                    <div class="p-3">
                        <h5 th:if="${comments.size()>0}" style="color: green">Comments</h5>
                        <h5 th:if="${comments.size()<1}" style="color: red">NO COMMENT YET</h5>
                    </div>
                    <form th:action="'lessons/addComment/'+${lesson.getId()}" method="post">
                        <div class="mt-3 d-flex flex-row align-items-center p-3 form-color">
                            <img th:if="${photo !=null and photo.length()>1000}"
                                 th:src="'data:image/jpg;base64, '+${photo}" width="50" class="rounded-circle mr-2">
                            <img th:if="${photo ==null or photo.length()<1000}"
                                 src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRPpWe4yPYrOwtWCIIBRPVY8zgCf9M0w9EfrKe8qdPu_vtBQL7oHciu3u5q2yao_dbK4IE&usqp=CAU"
                                 width="50" class="rounded-circle mr-2">
                            <input type="text" name="body" class="form-control" placeholder="Enter your comment...">
                        </div>
                    </form>
                    <div class="mt-2" th:each="comment : ${comments}">
                        <div class="d-flex flex-row p-3">
                            <img th:if="${comment.getAttachment() !=null and photo.length()>1000}" th:src="'data:image/jpg;base64, '+${comment.getAttachment()}" width="40" height="40"
                                    class="rounded-circle mr-3" alt="any thing">
                            <img th:if="${comment.getAttachment() ==null or photo.length()<1000}" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRPpWe4yPYrOwtWCIIBRPVY8zgCf9M0w9EfrKe8qdPu_vtBQL7oHciu3u5q2yao_dbK4IE&usqp=CAU" width="40" height="40"
                                    class="rounded-circle mr-3" alt="any thing">
                            <div class="w-100">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="d-flex flex-row align-items-center"><span
                                            th:text="${comment.getUserFullName()}" class="mr-2"></span> <small
                                            class="c-badge">Top Comment</small></div>
                                    <small th:text="${comment.getPostedAt()}"></small><small
                                        th:if="${userId == comment.getUserId()}"><a
                                        th:href="'/lessons/del/'+${lesson.getId()}+'/'+${comment.getId()}"><i
                                        class="fas fa-trash fa-sm"></i></a> </small>
                                </div>
                                <p class="text-justify comment-text mb-0" th:text="${comment.getBody()}"></p>
                                <div class="d-flex flex-row user-feed"><span class="wish"><i
                                        class="fa fa-heartbeat mr-2"></i>24</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<style>
    .center {
        margin: auto;
        width: 50%;
    }
</style>
</html>
